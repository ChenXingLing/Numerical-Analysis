## **Code4**

### **1.目标**

使用 Matlab 实现 Richardson 外推算法计算 $f'(x)$（取$h=1$），输出相应三角阵列。

函数 $f(x)$ 分别取：

- $\ln x$（计算 $x=3,M=3$）

- $\tan x$（计算 $x=sin^{-1}(0.8),M=4$）

- $\sin(x^2+\frac{x}{3})$（计算 $x=0,M=5$）

### **2.算法**

令 $\varphi(h)=\frac{f(x+h)-f(x-h)}{2h}$，则三角阵列：$D(n,k)\begin{cases}\varphi(\frac{h}{2^n})&,k=0\\\frac{4^kD(n,k-1)-D(n-1,k-1)}{4^k-1}&,k\leqslant n \end{cases}$ $(n\leqslant M)$，其中 $M$ 为执行步数。

$D(M,M)$ 即为所求。

### **3.结果**

|$f(x)=\ln x$||||
| :--: | :--: | :--: | :--: |
| $0.346574$  |  $-$  |    $-$    |  $-$  |
| $0.336472$ |  $0.333105$  | $-$ |  $-$  |
| $0.334108$ |  $0.333320$  | $0.333334$ |  $-$  |
| $0.333526$ |  $0.333333$  | $0.333333$ |  $0.333333$  |

<div STYLE="page-break-after: always;"></div>
|$f(x)=\tan x$|||||
| :--: | :--: | :--: | :--: | :--: |
| $-1.306186$  |  $-$  |    $-$    |  $-$  |    $-$    |
| $6.465336$ |  $9.055844$  | $-$ |  $-$  | $-$ |
| $3.209100$ |  $2.123688$  | $1.661544$ |  $-$  | $-$ |
| $2.872980$ |  $2.760940$  | $2.803424$ |  $2.821549$  | $-$ |
| $2.800902$| $2.776876$| $2.777938$| $2.777534$| $2.777361$ |

|$f(x)=\sin(x^2+\frac{x}{3})$| | | | | |
| :--: | :--: | :--: | :--: | :--: | :--: |
| $0.176784$ |  $-$ | $-$ |  $-$  | $-$ | $-$ |
| $0.321478$ |  $0.369709$  | $-$ |  $-$  | $-$ | $-$ |
| $0.332298$ |  $0.335904$  | $0.333651$ |  $-$  | $-$ | $-$ |
| $0.333196$ |  $0.333496$  | $0.333335$ |  $0.333330$  | $-$ | $-$ |
| $0.333307$ |  $0.333343$  | $0.333333$ |  $0.333333$  | $0.333333$ | $-$ |
| $0.333327$ |  $0.333334$  | $0.333333$ |  $0.333333$  | $0.333333$ | $0.333333$ |

### **4.代码**

```python

format long
Richardson(@log,1,3,3);
Richardson(@tan,1,asin(0.8),4);
Richardson(@f3,1,0,5);

function Ans_f = Richardson(f,h,x,M)
    D=zeros(M+1,M+1);    
    for i=0:M
        D(i+1,0+1)=(f(x+h)-f(x-h))*0.5/h;
        h=h/2.0;
    end
    for k=1:M
        for n=k:M
            D(n+1,k+1)=((4^k)*D(n+1,k-1+1)-D(n-1+1,k-1+1))/((4^k)-1);
        end
    end
    for i=0:M
        for j=0:i
            fprintf("%.6f ",D(i+1,j+1));
        end
        fprintf("\n");
    end
    Ans_f=D;
end

function Ans_f3 = f3(x)
    Ans_f3=sin(x*x+x/3.0);
end
```