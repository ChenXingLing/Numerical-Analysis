## **Code 8.3.2**

### **1.目标**

使用 Matlab 实现四阶龙格-库塔方法，在区间 $[0,5]$ 上求解初值问题 $\begin{cases}x'=\lambda x+\cos t-\lambda\sin t\\x(0)=0 \end{cases}$，计算数值解和精确解的误差 $error$，步长 $h=0.01$，$\lambda$ 分别取 $5,-5,-10$。

### **2.算法**

精确解：$x(t)=\sin t$ 。

四阶 $\text{Runge-Kutta}$：$x(t+h)=x(t)+\frac{1}{6}(F_1+2F_2+2F_3+F_4)$，其中 $f(t,x)=\lambda x+\cos t-\lambda \sin t$， $\begin{cases}F_1=hf(t,x)\\F_2=hf(t+\frac{h}{2},x+\frac{F_1}{2})\\F_3=hf(t+\frac{h}{2},x+\frac{F2}{2})\\F_4=hf(t+h,x+F_3) \end{cases}$

<div STYLE="page-break-after: always;"></div>
### **3.结果**

|【$\lambda=5$】|$t$|数值解 $x(t)$|精确解 $x(t)$|$error$|
| :--: | :--: | :--: | :--: | :--: |
| i=1 | 0.01 | 0.00999983 | 0.00999983 | 8.43226e-12 |
| i=2 | 0.02 | 0.0199987 | 0.0199987 | 1.60028e-11 |
| i=3 | 0.03 | 0.0299955 | 0.0299955 | 2.26668e-11 |
| i=4 | 0.04 | 0.0399893 | 0.0399893 | 2.83772e-11 |
| i=5 | 0.05 | 0.0499792 | 0.0499792 | 3.30845e-11 |
|...|...|...|...|...|
| i=496 | 4.96 | 17.5936 | -0.969501 | 18.5631 |
| i=497 | 4.97 | 18.5479 | -0.967001 | 19.5149 |
| i=498 | 4.98 | 19.551 | -0.964405 | 20.5154 |
| i=499 | 4.99 | 20.6055 | -0.961713 | 21.5673 |
| i=500 | 5 | 21.7141 | -0.958924 | 22.673 |

<div STYLE="page-break-after: always;"></div>
|【$\lambda=-5$】|$t$|数值解 $x(t)$|精确解 $x(t)$|$error$|
| :--: | :--: | :--: | :--: | :--: |
| i=1 | 0.01 | 0.00999983 | 0.00999983 | 8.85934e-12 |
| i=2 | 0.02 | 0.0199987 | 0.0199987 | 1.85793e-11 |
| i=3 | 0.03 | 0.0299955 | 0.0299955 | 2.9117e-11 |
| i=4 | 0.04 | 0.0399893 | 0.0399893 | 4.04312e-11 |
| i=5 | 0.05 | 0.0499792 | 0.0499792 | 5.2483e-11 |
|...|...|...|...|...|
| i=496 | 4.96 | -0.969501 | -0.969501 | 2.58939e-09 |
| i=497 | 4.97 | -0.967001 | -0.967001 | 2.58631e-09 |
| i=498 | 4.98 | -0.964405 | -0.964405 | 2.58297e-09 |
| i=499 | 4.99 | -0.961713 | -0.961713 | 2.57937e-09 |
| i=500 | 5 | -0.958924 | -0.958924 | 2.57551e-09 |

<div STYLE="page-break-after: always;"></div>
|【$\lambda=-10$】|$t$|数值解 $x(t)$|精确解 $x(t)$|$error$|
| :--: | :--: | :--: | :--: | :--: |
| i=1 | 0.01 | 0.00999983 | 0.00999983 | 3.64165e-11 |
| i=2 | 0.02 | 0.0199987 | 0.0199987 | 7.9764e-11 |
| i=3 | 0.03 | 0.0299955 | 0.0299955 | 1.29378e-10 |
| i=4 | 0.04 | 0.0399893 | 0.0399893 | 1.84657e-10 |
| i=5 | 0.05 | 0.0499792 | 0.0499792 | 2.45055e-10 |
|...|...|...|...|...|
| i=496 | 4.96 | -0.969501 | -0.969501 | 1.07079e-08 |
| i=497 | 4.97 | -0.967001 | -0.967001 | 1.06881e-08 |
| i=498 | 4.98 | -0.964405 | -0.964405 | 1.06672e-08 |
| i=499 | 4.99 | -0.961713 | -0.961713 | 1.06453e-08 |
| i=500 | 5 | -0.958924 | -0.958924 | 1.06223e-08 |

<div STYLE="page-break-after: always;"></div>
### **4.代码**

```python
fprintf("lambda=5:\n");RungeKutta(5);
fprintf("lambda=-5:\n");RungeKutta(-5);
fprintf("lambda=10:\n");RungeKutta(-10);

function RungeKutta(lam)
f=@(t,x) lam*x+cos(t)-lam*sin(t);
real_x=@(t) sin(t);
t=0;x=0;h=0.01;M=500;
for i=1:M
    F1=h*f(t,x);
    F2=h*f(t+h/2,x+F1/2);
    F3=h*f(t+h/2,x+F2/2);
    F4=h*f(t+h,x+F3);
    x=x+(F1+2*F2+2*F3+F4)/6;
    t=t+h;
    error=abs(real_x(t)-x);
    fprintf("| i=%d | %g | %g | %g | %g |\n",i,t,x,real_x(t),error);
end
fprintf("\n");
end
```